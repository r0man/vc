{"id":"vc-217","title":"Sandbox Lifecycle Management","description":"CURRENT: No sandboxes. Agents work directly in main repo. No isolation between missions. Manual git operations.\n\nNEEDED: Automatic sandbox lifecycle for missions using git worktrees.\n\nEach mission gets:\n- Dedicated sandbox directory (.sandboxes/mission-XXX/)\n- Dedicated git branch (mission/vc-XXX-title)\n- Shared by all workers on that mission\n- Auto-created on mission start\n- Auto-cleaned on mission close\n\nWorkers on same mission see each other's commits (shared context).\n\nFROM: MISSIONS.md roadmap Epic 2 (P0)","design":"Database schema:\n- Add issue.sandbox_path TEXT\n- Add issue.branch_name TEXT\n- Store per mission epic\n\nLifecycle functions:\n1. CreateSandbox(missionID):\n   - Generate sandbox path: .sandboxes/mission-{ID}/\n   - Generate branch name: mission/{ID}-{slug}\n   - git worktree add {path} -b {branch}\n   - Update mission issue: sandbox_path, branch_name\n   - Add label: sandbox:mission-{ID}\n\n2. CleanupSandbox(missionID):\n   - git worktree remove {sandbox_path}\n   - git branch -D {branch_name}\n   - Remove label: sandbox:mission-{ID}\n\nAgent executor changes:\n- Before claiming task: lookup mission sandbox\n- Execute agent in sandbox directory\n- Commits go to mission branch\n\nExecutor integration:\n- Mission creation: auto-call CreateSandbox()\n- Mission close: auto-call CleanupSandbox()\n- Task claiming: pass sandbox path to agent","acceptance_criteria":"- issue.sandbox_path and branch_name fields added\n- CreateSandbox() creates worktree + branch\n- CleanupSandbox() removes worktree + branch\n- Agent executor uses mission sandbox\n- Multiple tasks in same mission share sandbox\n- Sandbox cleaned up on mission close\n- Tests: create mission, verify sandbox exists\n- Tests: close mission, verify sandbox removed\n- Tests: multiple workers share sandbox (sequential)","notes":"Epic broken down into 6 child tasks:\n\nvc-241: Add sandbox_path and branch_name to vc_mission_state table [READY]\nvc-242: Implement CreateMissionSandbox() lifecycle function [BLOCKED by vc-241]\nvc-243: Implement CleanupMissionSandbox() lifecycle function [BLOCKED by vc-241]\nvc-244: Update executor to use mission sandboxes [BLOCKED by vc-242]\nvc-245: Auto-cleanup sandbox on mission close [BLOCKED by vc-243, vc-244]\nvc-246: Add comprehensive tests [BLOCKED by vc-245]\n\nDependency chain:\n- vc-241 is ready (no blockers)\n- vc-242 and vc-243 can run in parallel after vc-241\n- vc-244 needs vc-242 complete\n- vc-245 needs both vc-243 and vc-244 complete\n- vc-246 is last (tests all functionality)\n\nSee 'bd dep tree vc-217' for full dependency graph.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-10-28T15:40:36.797252-07:00","updated_at":"2025-10-29T12:44:17.447823-07:00","closed_at":"2025-10-29T12:44:17.447823-07:00","dependencies":[{"issue_id":"vc-217","depends_on_id":"vc-215","type":"parent-child","created_at":"2025-10-28T15:40:58.876069-07:00","created_by":"stevey"},{"issue_id":"vc-217","depends_on_id":"vc-216","type":"blocks","created_at":"2025-10-28T15:41:03.976916-07:00","created_by":"stevey"}]}
